$(function(){var a="inc/data/data.json";App.DataBind.init(a),App.DataBind.change.init(a),App.Gallery.init()});var App=App||{};App.DataBind=function(a,b){function c(a,b,c){this.member_id=a[b].member_id,this.member_name=a[b].member_name,this.item_id=a[b].item_id,this.item_name=a[b].item_name,this.item_category=a[b].item_category,this.item_src=a[b].item_src,this.addList(c)}c.prototype.addList=function(a){a.append('<li class="box"><div class="caption"><a href="inc/img/b/'+this.item_src+'" class="expand"><img src="inc/img/t/'+this.item_src+'" /></a></div><div class="capture">'+this.member_name+"<br />"+this.item_category+"</div></li>")};var d={init:function(a){var c=this;b.ajax({url:a,type:"GET",cache:!1,dataType:"json",success:function(a){c.getDataAll(a),c.addSelectList.init(a),c.addClassLastBox()},complete:function(){var a=b(".last img");a.load(function(){c.removeLoading(),c.anime(),c.preload()})}})},change:{init:function(a){var c=this,e=b("#name"),f=b("#category");e.on("change submit",function(){var e=b(this).val(),g=f.val();d.showLoading(),c.ajax(e,"member_name",g,"item_category",d,a)}),f.on("change",function(){var f=b(this).val(),g=e.val();d.showLoading(),c.ajax(f,"item_category",g,"member_name",d,a)})},ajax:function(a,c,d,e,f,g){var h=this;b.ajax({url:g,type:"GET",cache:!1,dataType:"json",success:function(b){"all"==d?h.case_single(b,a,c,f):h.case_dual(b,a,c,d,e,f),f.addClassLastBox()},complete:function(){var a=b(".last img");a.load(function(){f.removeLoading(),f.anime()})}})},case_single:function(a,b,c,d){"all"==b?d.getDataAll(a):d.getDataFilter(a,b,c)},case_dual:function(a,b,c,d,e,f){"all"==b&&"all"==d?f.getDataAll(a):"all"==b||"all"==d?f.getDataFilter(a,d,e):f.getDataPluralFilter(a,b,c,d,e)}},getDataAll:function(a){var b=a;this.display(b)},getDataFilter:function(a,b,c){var d=a,e=[],f=new RegExp(b,"i");e=d.filter(function(a){return a[c].match(f)?!0:void 0}),this.display(e)},getDataPluralFilter:function(a,b,c,d,e){var f=a,g=[],h=new RegExp(d,"i"),i=new RegExp(b,"i");g=f.filter(function(a){return a[e].match(h)?!0:void 0}).filter(function(a){return a[c].match(i)?!0:void 0}),0===g.length&&(this.removeLoading(),alert("データがありません")),this.display(g)},display:function(a){var d=a.length,e=b("#gallery");e.empty();for(var f=0;d>f;f++)new c(a,f,e)},addClassLastBox:function(){var a=b(".box:last-child");a.addClass("last")},anime:function(){var a=b(".box");a.addClass("anime_in")},showLoading:function(){var a=b("#loading");a.show()},removeLoading:function(){var a=b("#loading");a.fadeOut()},addSelectList:{init:function(a){this.util(a,"item_category","#category"),this.util(a,"member_name","#name")},util:function(a,c,d){for(var e=a.length,f=[],g=0;e>g;g++)f.push(a[g][c]);for(var f=f.filter(function(a,b,c){return c.indexOf(a)===b}),e=f.length,g=0;e>g;g++){var h=b(d);h.append("<option value='"+f[g]+"'>"+f[g]+"</option>")}}},preload:function(){b(".expand img").each(function(){var a=b(this).attr("src"),a=a.replace("/t/","/b/");b("<img />").attr("src",a)})}};return d}(this,jQuery),App.Gallery=function(a,b){var c={init:function(){var a=this,c=b(document);c.on("click",".expand",function(c){c.preventDefault();var d=b(this);d.parent().parent().addClass("current"),a.addImg(d)}),c.on("click",".exBox img",function(c){c.preventDefault();var d=b(this).parent().parent();b(".current").removeClass("current"),a.removeImg(d)}),c.on("click",".next",function(b){b.preventDefault(),a.sendPage("next")}),c.on("click",".prev",function(b){b.preventDefault(),a.sendPage("prev")})},sendPage:function(a){var c=b(".current");if("next"===a)var d=c.next(),e=c.next().find("a");else if("prev"===a)var d=c.prev(),e=c.prev().find("a");b(".exBox").remove(),this.addImg(e),c.removeClass("current"),d.addClass("current")},addImg:function(c){var d=b(a),e=b("body"),f=c.parent().parent(),g=c.attr("href"),h=d.scrollTop(),i=d.height(),j=e.height();if(i>j)var j=i;e.append('<div class="exBox" style="height:'+j+'px;"><div><a href="#" class="btn prev">PREV</a><a href="#" class="btn next">NEXT</a><img src="'+g+'" /></div></a>'),b(".exBox img").on("load",function(){var a=b(this),c=a.height(),d=(i-c)/2+h;if(c>i)var d=h,c=i;b(".exBox").css({paddingTop:d}),a.css({height:c}).addClass("anime_in")}),f.next().size()?f.prev().size()||b(".prev").hide():b(".next").hide()},removeImg:function(a){a.remove()}};return c}(this,jQuery);